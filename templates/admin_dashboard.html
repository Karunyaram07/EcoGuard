<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4 bg-light">

  <h2 class="text-center mb-4">Admin Dashboard - Validate Complaints</h2>

  <div class="container">
    <table class="table table-bordered table-striped table-hover align-middle">
      <thead class="table-dark text-center">
        <tr>
          <th>ID</th>
          <th>Email</th>
          <th>Message</th>
          <th>Date</th>
          <th>Image</th>
          <th>Category</th>
          <th>AI Verification</th>
          <th>Update Status</th>
        </tr>
      </thead>

      <tbody>
        {% for c in comp %}
        <tr>
          <td class="text-center">{{ c.cid }}</td>
          <td>{{ c.email }}</td>
          <td>{{ c.title or c.message[:100] }}</td>
          <td>{{ c.date }}</td>
          <td class="text-center">
            {% if c.image %}
              <a href="{{ url_for('static', filename='uploads/' ~ c.image) }}" target="_blank">View</a>
            {% else %}
              N/A
            {% endif %}
          </td>
          <td>{{ c.category or 'â€”' }}</td>
          <td class="text-center">
            {% if c.ai_verified %}
              <span class="badge bg-success">AI-Verified</span>
              <small>({{ '%.2f'|format(c.ai_confidence or 0) }})</small>
            {% else %}
              <span class="badge bg-danger">AI-Unverified</span>
            {% endif %}
          </td>
          <td>
            <form method="POST" action="{{ url_for('update_status', cid=c.cid) }}" class="d-flex justify-content-center">
              <select name="status" class="form-select form-select-sm w-auto me-2">
                <option value="Submitted" {% if c.status == 'Submitted' %}selected{% endif %}>Submitted</option>
                <option value="In Progress" {% if c.status == 'In Progress' %}selected{% endif %}>In Progress</option>
                <option value="Verified" {% if c.status == 'Verified' %}selected{% endif %}>Verified</option>
                <option value="Resolved" {% if c.status == 'Resolved' %}selected{% endif %}>Resolved</option>
              </select>
              <button type="submit" class="btn btn-primary btn-sm">Update</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="text-center">
    <a href="{{ url_for('logout') }}" class="btn btn-danger mt-3">Logout</a>
  </div>

</body>
</html>
